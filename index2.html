<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Victorian Traffic Behaviour and Accessibility</title>

    <!-- Vega and Vega-Lite libraries -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Afacad+Flux:wght@100..1000&display=swap" rel="stylesheet"> 

    <style>
        body {
            background-color: #c5e6f0;
            font-family: 'Afacad Flux', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .description-full {
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        .full-width-row {
            width: 100%;
            max-width: 1200px;
            margin-bottom: 20px;
        }
        .map-container {
            height: 700px; /* Make the map taller */
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
            background-color: white;
            border-radius: 15px;
            overflow: hidden;
        }
        .description-full {
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            background-color: white;
        }
        .row {
            display: flex;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 20px;
            align-items: center;
        }
        .visualization {
            flex: 2; /* Allocates more space to the visualization */
            min-width: 78%;
            height: 500px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
            border-radius: 15px;
            overflow: hidden;
            background-color: white;
        }
        .description {
            flex: 1; /* Allocates less space to the text */
            min-width: 22%;
            padding: 20px;
            font-size: 1.1rem;
            
        }
        /* Alternate rows */
        .row:nth-child(odd) .visualization {
            order: 1;
        }
        .row:nth-child(odd) .description {
            order: 2;
        }
        .row:nth-child(even) .visualization {
            order: 2;
        }
        .row:nth-child(even) .description {
            order: 1;
        }
    </style>
</head>
<body>

    <h1>Victorian Traffic Behaviour and Accessibility</h1>
    <div class = "description-full">
        <p> This is a dashboard that describes and visualises important Victorian traffic and road travel information
            This includes a choropleth map of all rest stops in Victoria, including what services are offered. There are also plots
            pertaining to annual traffic volume of vehicles per local government area (LGA), and also the direction of traffic flow. </p>
    </div>

    <!-- First Row (Full Width Map) -->
    <div class="full-width-row">
        <div id="map" class="map-container"></div>
    </div>

    <!-- Description for the Map -->
    <div class="description-full">
        <p> This map displays all rest area locations in Victoria.
            When hovering on a point, _________ features are detailed.
        </p>
    </div>

    <!-- Second Row -->
    <div class="row">
        <div id="vis1" class="visualization"></div>
        <div class="description">
            <p>We can see that on average, Hobson's Bay has the highest annual daily traffic volume (approximately 27,700 vehicles).</p>
        </div>
    </div>

    <!-- Third Row -->
    <div class="row">
        <div class="description">
            <p>Description of the second plot goes here. Additional data visualization to provide context and insights.</p>
        </div>
        <div id="vis2" class="visualization"></div>
    </div>

    <!-- Fourth Row -->
    <div class="row">
        <div id="vis3" class="visualization"></div>
        <div class="description">
            <p>Description of the third plot goes here. This visualization helps to understand patterns and trends.</p>
        </div>
    </div>

    <script type="text/javascript">
        // First Visualization (Map)
        const mapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Rest Area Locations in Victoria",
            "width": 1200,
            "height": 600,
            "selection": {
                "brush": {
                "type": "interval"
                }
            },
            // "params": [
            //     {
            //         "name": "zoom_level",
            //         "value": 30000,
            //         "bind": {
            //             "input": "range",
            //             "min": 3500,
            //             "max": 60000,
            //             "step": 100,
            //             "name": "Zoom: "
            //         }
            //     }
            // ],
            
            "projection": {
                "type": "mercator",
                // "scale": {"expr": "zoom_level"}
            },
            "layer": [
            {
                "data": {
                "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/vic_suburb_borders.json",
                "format": {"type": "topojson", "feature": "vic_suburb_borders"}
                },
                "params": [{
                    "name": "grid",
                    "select": "interval",
                    "bind": "scales"
                }],
                "background": "grey",
                "mark": {
                    "type": "geoshape",
                    "stroke": "black",
                    "strokeWidth": 0.5,
                    "fill": "#b9e1ed"
                }
            },
            {
                "data": {
                "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Rest_Area.json",
                "format": {"type": "topojson", "feature": "Rest_Area"}
                },
                
                
                "mark": {
                "type": "circle",
                "color": "green",
                "size": 50
                },
                "encoding": {
                    "longitude": {"field": "geometry.coordinates[0]", "type": "quantitative"},
                    "latitude": {"field": "geometry.coordinates[1]", "type": "quantitative"},
                    "tooltip": [
                        {"field": "properties.RESTAREANAME", "type": "nominal", "title": "Rest Area Name"},
                        {"field": "properties.RESTAREATYPE", "type": "nominal", "title": "Rest Area Type"},
                        {"field": "properties.ROADSPEEDLIMIT", "type": "nominal", "title": "Road Speed Limit"},
                        {"field": "properties.COMMERCIALACTIVITY", "type": "nominal", "title": "Commercial Activity"}
                ]
                }
            }
            ]
        };
        vegaEmbed('#map', mapSpec).catch(console.error);

        // Second Visualization
        const spec2 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Annual Traffic Volume per Local Government Area",
            "description": "A bar chart showing ALLVEHS_AADT by LGA_SHORT_NM.",
            "width": "container",
            "height": "container",
            "data": {
            "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Traffic_Volume.csv",
            "format": {"type": "csv"}
            },
            "transform": [{
                "filter": "(datum.ALLVEHS_AADT > 5000) && (datum.LGA_SHORT_NM != 'Missing Data')",

            }],
            "config": {
                "title": {
                    "font": "Afacad Flux",
                    "fontSize": 18
                },
                "axis": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    },
                    "legend": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    }
                
            },
            "mark": "bar",
            "encoding": {
            "x": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "title": "Local Government Area",
                "sort": "-y"  
            },
            "y": {
                "aggregate": "average",
                "field": "ALLVEHS_AADT",
                "type": "quantitative",
                "title": "Average Annual Daily Traffic (ALLVEHS_AADT)"
            },
            "color": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "legend": null,
                "scale": {"scheme": "category20c"}
            },
            "tooltip": [
                {"field": "LGA_SHORT_NM", "type": "nominal", "title": "LGA"},
                {"aggregate": "average", "field": "ALLVEHS_AADT", "type": "quantitative", "title": "AADT"}
            ]
            }
        }
        vegaEmbed('#vis1', spec2).catch(console.error);

        // Third Visualization
        const spec3 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Annual Traffic Volume by Flow Direction",
            "description": "A bar chart showing ALLVEHS_AADT by LGA_SHORT_NM.",
            "width": "container",
            "height": "container",
            "data": {
            "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Traffic_Volume.csv",
            "format": {"type": "csv"}
            },
            "params": [{
                "name": "grid",
                "select": "interval",
                "bind": "scales"
            }],
            "transform": [{
                "filter": "datum.ALLVEHS_AADT > 10000"
            }],
            "config": {
                "title": {
                    "font": "Afacad Flux",
                    "fontSize": 18
                },
                "axis": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    },
                    "legend": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    }
                
            },
            "mark": "bar",
            "encoding": {
            "y": {
                "field": "FLOW",
                "type": "nominal",
                "title": "Flow Direction",
                "sort": "-y"  
            },
            "x": {
                "aggregate": "average",
                "field": "ALLVEHS_AADT",
                "type": "quantitative",
                "title": "Average Annual Daily Traffic (ALLVEHS_AADT)"
            },
            "color": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "legend": {
                    "title": "Local Government Area",
                    "columns": 2,
                    "labelLimit": 500,       
                    "symbolLimit": 50  
                },
                "scale": {"scheme": "category20c"}
            },
            "tooltip": [
                {"field": "LGA_SHORT_NM", "type": "nominal", "title": "LGA"},
                {"aggregate": "average","field": "ALLVEHS_AADT", "type": "quantitative", "title": "AADT"}
            ]
            }
        }
        vegaEmbed('#vis2', spec3).catch(console.error);

        // Fourth Visualization
        const spec4 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Change in Trip Time From 2012-2019 Depending on Trip Purpose",
            "data": {
                "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Victorian_travel_data_main.csv",
                "format": {"type": "csv"}
            },
            "transform": [
                {
                    "filter": "datum.trippurp != 'Unknown Purpose'"
                },
                {
                    "calculate": "datum.trippurp == 'Change Mode' ? 'Change Mode of Transport' : datum.trippurp",
                    "as": "trippurp"  
                }
            ],
            "config": {
                "title": {
                    "font": "Afacad Flux",
                    "fontSize": 18
                },
                "axis": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    },
                    "legend": {
                    "labelFont": "Afacad Flux",
                    "titleFont": "Afacad Flux",
                    "labelFontSize": 12,
                    "titleFontSize": 14
                    }
                
            },
            "selection": {
                "tripPurpose": {
                    "type" : "single",
                    "fields": ["trippurp"],
                    "bind": "legend",
                    "empty": "all"
                }
            },
            "width": "container",
            "height": "container",
            "mark": "line",
            "encoding": {
                "x": {
                "field": "year",
                "type": "temporal",
                "timeUnit": "year",
                "title": "Year",
                "axis": {"format": "%Y"}
                },
                "y": {
                    "aggregate": "average",
                "field": "triptime",
                "type": "quantitative",
                "title": "Trip Time"
                },
                "color": {
                    "field": "trippurp",
                    "type": "nominal",
                    "title": "Trip Purpose",
                    "scale": {"scheme": "category20c"},
                    "legend": {"title": "Trip Purpose"}
                },
                "tooltip": [
                {"field": "year", "type": "temporal", "title": "Year"},
                {"aggregate": "average","field": "triptime", "type": "quantitative", "title": "Trip Time"},
                {"field": "trippurp", "type": "nominal", "title": "Trip Purpose"}
                ]
            }
        };
        vegaEmbed('#vis3', spec4).catch(console.error);
    </script>

</body>
</html>
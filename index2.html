<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Visualizations</title>

    <!-- Vega and Vega-Lite libraries -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <style>
        body {
            background-color: white;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .full-width-row {
            width: 100%;
            max-width: 1200px;
            margin-bottom: 20px;
        }
        .map-container {
            height: 800px; /* Make the map taller */
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
        }
        .description-full {
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .row {
            display: flex;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 20px;
            align-items: center;
        }
        .visualization {
            flex: 2; /* Allocates more space to the visualization */
            min-width: 75%;
            height: 500px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
        }
        .description {
            flex: 1; /* Allocates less space to the text */
            min-width: 25%;
            padding: 20px;
            font-size: 1.1rem;
        }
        /* Alternate rows */
        .row:nth-child(odd) .visualization {
            order: 1;
        }
        .row:nth-child(odd) .description {
            order: 2;
        }
        .row:nth-child(even) .visualization {
            order: 2;
        }
        .row:nth-child(even) .description {
            order: 1;
        }
    </style>
</head>
<body>

    <h1>Data Visualizations</h1>

    <!-- First Row (Full Width Map) -->
    <div class="full-width-row">
        <div id="map" class="map-container"></div>
    </div>

    <!-- Description for the Map -->
    <div class="description-full">
        <p>This is a dashboard that describes and visualises important Victorian traffic and road travel information
            This includes a choropleth map of all rest stops in Victoria, including what services are offered. There are also plots
            pertaining to annual traffic volume of vehicles per local government area (LGA), and also the direction of traffic flow.</p>
    </div>

    <!-- Second Row -->
    <div class="row">
        <div id="vis1" class="visualization"></div>
        <div class="description">
            <p>Description of the first plot goes here. This visualization shows key insights or metrics for analysis.</p>
        </div>
    </div>

    <!-- Third Row -->
    <div class="row">
        <div class="description">
            <p>Description of the second plot goes here. Additional data visualization to provide context and insights.</p>
        </div>
        <div id="vis2" class="visualization"></div>
    </div>

    <!-- Fourth Row -->
    <div class="row">
        <div id="vis3" class="visualization"></div>
        <div class="description">
            <p>Description of the third plot goes here. This visualization helps to understand patterns and trends.</p>
        </div>
    </div>

    <script type="text/javascript">
        // First Visualization (Map)
        const mapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Rest Area Locations in Victoria",
            "width": 1200,
            "height": 600,
            "selection": {
                "brush": {
                "type": "interval"
                }
            },
            
            "projection": {"type": "mercator"},
            "layer": [
            {
                "data": {
                "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/vic_suburb_borders.json",
                "format": {"type": "topojson", "feature": "vic_suburb_borders"}
                },
                "params": [{
                    "name": "grid",
                    "select": "interval",
                    "bind": "scales"
                }],
                "background": "grey",
                "mark": {
                    "type": "geoshape",
                    "stroke": "black",
                    "strokeWidth": 0.5,
                    "fill": "#70b6db"
                }
            },
            {
                "data": {
                "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Rest_Area.json",
                "format": {"type": "topojson", "feature": "Rest_Area"}
                },
                
                
                "mark": {
                "type": "circle",
                "color": "blue",
                "size": 50
                },
                "encoding": {
                    "longitude": {"field": "geometry.coordinates[0]", "type": "quantitative"},
                    "latitude": {"field": "geometry.coordinates[1]", "type": "quantitative"},
                    "tooltip": [
                        {"field": "properties.RESTAREANAME", "type": "nominal", "title": "Rest Area Name"},
                        {"field": "properties.RESTAREATYPE", "type": "nominal", "title": "Rest Area Type"},
                        {"field": "properties.ROADSPEEDLIMIT", "type": "nominal", "title": "Road Speed Limit"},
                        {"field": "properties.COMMERCIALACTIVITY", "type": "nominal", "title": "Commercial Activity"}
                ]
                }
            }
            ]
        };
        vegaEmbed('#map', mapSpec).catch(console.error);

        // Second Visualization
        const spec2 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Annual Traffic Volume per Local Government Area",
            "description": "A bar chart showing ALLVEHS_AADT by LGA_SHORT_NM.",
            "width": 800,
            "data": {
            "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Traffic_Volume.csv",
            "format": {"type": "csv"}
            },
            "transform": [{
                "filter": "datum.ALLVEHS_AADT > 5000"
            }],
            "mark": "bar",
            "encoding": {
            "x": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "title": "Local Government Area",
                "sort": "-y"  
            },
            "y": {
                "aggregate": "average",
                "field": "ALLVEHS_AADT",
                "type": "quantitative",
                "title": "Average Annual Daily Traffic (ALLVEHS_AADT)"
            },
            "color": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "legend": null  
            },
            "tooltip": [
                {"field": "LGA_SHORT_NM", "type": "nominal", "title": "LGA"},
                {"aggregate": "average", "field": "ALLVEHS_AADT", "type": "quantitative", "title": "AADT"}
            ]
            }
        }
        vegaEmbed('#vis1', spec2).catch(console.error);

        // Third Visualization
        const spec3 = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "title": "Annual Traffic Volume by Flow Direction",
            "description": "A bar chart showing ALLVEHS_AADT by LGA_SHORT_NM.",
            "height": 400,
            "width": 700,
            "data": {
            "url": "https://raw.githubusercontent.com/nt-p/FIT3179/main/Data/Traffic_Volume.csv",
            "format": {"type": "csv"}
            },
            "params": [{
                "name": "grid",
                "select": "interval",
                "bind": "scales"
            }],
            "transform": [{
                "filter": "datum.ALLVEHS_AADT > 10000"
            }],
            "mark": "bar",
            "encoding": {
            "y": {
                "field": "FLOW",
                "type": "nominal",
                "title": "Flow Direction",
                "sort": "-y"  
            },
            "x": {
                "aggregate": "average",
                "field": "ALLVEHS_AADT",
                "type": "quantitative",
                "title": "Average Annual Daily Traffic (ALLVEHS_AADT)"
            },
            "color": {
                "field": "LGA_SHORT_NM",
                "type": "nominal",
                "legend": null  
            },
            "tooltip": [
                {"field": "LGA_SHORT_NM", "type": "nominal", "title": "LGA"},
                {"aggregate": "average","field": "ALLVEHS_AADT", "type": "quantitative", "title": "AADT"}
            ]
            }
        }
        vegaEmbed('#vis2', spec3).catch(console.error);

        // Fourth Visualization
        const spec4 = { /* Vega-Lite specification for the third plot */ };
        vegaEmbed('#vis3', spec4).catch(console.error);
    </script>

</body>
</html>